/* Riot 1.0.1, @license MIT, (c) 2014 Muut Inc + contributors */

(function(){var e,t,n,r,i;(function(e){function i(e,t){return e==undefined?"":(e+"").replace(/[&\"<>]/g,function(e){return r[e]})}function f(e){e=e.type?location.hash:e,e!=s&&o.trigger("pop",e),s=e}e.observable=function(e){var t={},n=[].slice;return e.on=function(n,r){return typeof r=="function"&&n.replace(/[^\s]+/g,function(e,n){(t[e]=t[e]||[]).push(r),r.typed=n>0}),e},e.off=function(n,r){if(n=="*")t={};else if(r){var i=t[n];for(var s=0,o;o=i&&i[s];++s)o===r&&i.splice(s,1)}else n.replace(/[^\s]+/g,function(e){t[e]=[]});return e},e.one=function(t,n){return n&&(n.one=!0),e.on(t,n)},e.trigger=function(r){var i=n.call(arguments,1),s=t[r]||[];for(var o=0,u;u=s[o];++o)u.busy||(u.busy=!0,u.apply(e,u.typed?[r].concat(i):i),u.one&&(s.splice(o,1),o--),u.busy=!1);return e},e};var t={},n={"\\":"\\\\","\n":"\\n","\r":"\\r","'":"\\'"},r={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};e.render=function(e,r,s){return s===!0&&(s=i),e=e||"",(t[e]=t[e]||new Function("_","e","return '"+e.replace(/[\\\n\r']/g,function(e){return n[e]}).replace(/{\s*([\w\.]+)\s*}/g,"' + (e?e(_.$1,'$1'):_.$1||(_.$1==undefined?'':_.$1)) + '")+"'"))(r,s)};if(typeof top!="object")return;var s,o=e.observable({}),u=window.addEventListener,a=document;u?(u("popstate",f,!1),a.addEventListener("DOMContentLoaded",f,!1)):a.attachEvent("onreadystatechange",function(){a.readyState==="complete"&&f("")}),e.route=function(e){if(typeof e=="function")return o.on("pop",e);history.pushState&&history.pushState(0,0,e),f(e)}})(typeof top=="object"?window.riot={}:exports),e=window.riot,t=function(e){var t;return t=function(){function t(){var e;this.isMuted=!1,this.volume=this.defaultVolume=.5,e=window.AudioContext||window.webkitAudioContext,this.context=new e,this.mergerNode=this.context.createChannelMerger(),this.gainNode=this.context.createGain(),this.mergerNode.connect(this.gainNode),this.gainNode.connect(this.context.destination),this.setVolume(this.defaultVolume)}return t.prototype=e.observable(t.prototype),t.instance=null,t.getInstance=function(){return this.instance==null&&(this.instance=new t),this.instance},t.prototype.play=function(e){var t,n;return n=this.context.createOscillator(),t=this.context.createGain(),n.type="square",n.frequency.value=e,t.gain.value=1,n.connect(t),t.connect(this.mergerNode),n.start(),t.gain.setTargetAtTime(0,this.context.currentTime+.2,.75)},t.prototype.setVolume=function(e){return this.volume=parseFloat(e,10),this.gainNode.gain.value=this.volume,this.trigger("gain",this.volume)},t.prototype.mute=function(){return this.isMuted=!0,this.setVolume(0),this.trigger("muted")},t.prototype.unmute=function(e){return e=e!=null?e:this.defaultVolume,this.isMuted=!1,this.setVolume(e),this.trigger("unmuted",e)},t.getFrequency=function(e){return Math.pow(2,e/12)*440},t}()}(e);var s=function(e,t){return function(){return e.apply(t,arguments)}};n=function(e){var n;return n=function(){function n(){this.onAudioUnmuted=s(this.onAudioUnmuted,this),this.onAudioMuted=s(this.onAudioMuted,this),this.onMuteClick=s(this.onMuteClick,this),this.onVolumeChange=s(this.onVolumeChange,this),this.audio=e.getInstance(),this.volumeRange=document.getElementById("volume"),this.muteButton=document.getElementById("mute"),this.volumeRange.value=t.defaultVolume,this.domListeners(),this.audioListeners()}return n.prototype.domListeners=function(){return this.volumeRange.addEventListener("change",this.onVolumeChange),this.muteButton.addEventListener("click",this.onMuteClick)},n.prototype.audioListeners=function(){return this.audio.on("muted",this.onAudioMuted),this.audio.on("unmuted",this.onAudioUnmuted)},n.prototype.onVolumeChange=function(){var e;return e=parseFloat(this.volumeRange.value,10),e===0?this.audio.mute():this.audio.isMuted?this.audio.unmute(e):this.audio.setVolume(e)},n.prototype.onMuteClick=function(){return this.audio.isMuted?this.audio.unmute():this.audio.mute()},n.prototype.onAudioMuted=function(){return this.muteButton.value="Unmute",this.volumeRange.value=0},n.prototype.onAudioUnmuted=function(e){return this.muteButton.value="Mute",this.volumeRange.value=e},n}()}(t);var s=function(e,t){return function(){return e.apply(t,arguments)}};r=function(e){var t;return t=function(){function n(){this.onStringClick=s(this.onStringClick,this),this.audio=e.getInstance(),this.stringsDiv=document.getElementById("strings"),this.domListeners()}var t;return t=[["A"],["A#","Bb"],["B"],["C"],["C#","Db"],["D"],["D#","Eb"],["E"],["F"],["F#","Gb"],["G"],["G#","Ab"]],n.prototype.domListeners=function(){return this.stringsDiv.addEventListener("click",this.onStringClick)},n.prototype.onStringClick=function(t){var n,r;if(t.target.tagName!=="BUTTON")return;return r=t.target.dataset.index,n=e.getFrequency(r),this.audio.play(n)},n}()}(t);var o;o=null,i=function(e,t){return o=function(){function n(){}return n.run=function(){return new e,new t},n}()}(n,r),document.addEventListener("DOMContentLoaded",function(){return o.run()})})();